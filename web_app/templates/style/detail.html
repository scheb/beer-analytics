{% extends 'base.html' %}
{% load web_app %}

{% block title %}{{ style.name }} â€¹ Beer Styles{% endblock %}

{% block content %}
    {% include './breadcrumb.html' %}
    <h1>{{ style.name }} <small class="text-muted ml-2" title="BJCP ID">{{ style.id }}</small></h1>

    {% if style.alt_names %}
        <p>Includes: <span class="badge bg-secondary">{{ style.alt_names_list|join:'</span><span class="invisible">, </span><span class="badge bg-secondary">' }}</span></p>
    {% endif %}

    {% if style.recipes_count %}
        <p>Number of recipes: <strong>{{ style.recipes_count }}</strong></p>
    {% endif %}

    {% if style.is_category %}
        <p>This is a <strong>beer style category</strong>, containing the following beer styles:</p>
    {% elif style.has_sub_styles %}
        <p>This beer style has some specialized <strong>sub-styles</strong>:</p>
    {% endif %}

    {% if style.has_sub_styles %}
        <ul>
            {% for style1 in style.sub_styles %}
                <li>
                    <a href="{% url "style_detail" style1.category.slug style1.slug %}">{{ style1.name }}</a>
                    {% if style1.has_sub_styles %}
                        <ul class="list-unstyled mt-1 mb-2 ml-2">
                            {% for style2 in style1.sub_styles %}
                                <li>
                                    <a href="{% url "style_detail" style2.category.slug style2.slug %}">{{ style2.name }}</a>
                                </li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    {% endif %}

    {% include './metrics.html' %}

    <h2>Popularity Over Time</h2>
    <div id="chart-popularity" class="chart-m">
        <noscript>
            {{ style|chart_image:"popularity"|safe }}
        </noscript>
    </div>

    <h2>Most Used Fermentables</h2>
    <nav id="chart-fermentables-tabs">
        <label for="chart-fermentables-tabs" class="float-left py-1 pr-2">Type:</label>
        <ul class="nav nav-pills" role="tablist">
            <li class="nav-item"><a class="nav-link px-2 py-1 active" aria-current="page" data-toggle="tab" role="tab" data-filter="" href="#chart-fermentables">Any</a></li>
            <li class="nav-item"><a class="nav-link px-2 py-1" data-toggle="tab" role="tab" data-filter="base" href="#chart-fermentables-base">Base Malt</a></li>
            <li class="nav-item"><a class="nav-link px-2 py-1" data-toggle="tab" role="tab" data-filter="cara-crystal" href="#chart-fermentables-cara-crystal">Caramel/Crystal</a></li>
            <li class="nav-item"><a class="nav-link px-2 py-1" data-toggle="tab" role="tab" data-filter="toasted" href="#chart-fermentables-toasted">Toasted</a></li>
            <li class="nav-item"><a class="nav-link px-2 py-1" data-toggle="tab" role="tab" data-filter="roasted" href="#chart-fermentables-roasted">Roasted</a></li>
            <li class="nav-item"><a class="nav-link px-2 py-1" data-toggle="tab" role="tab" data-filter="other-grain" href="#chart-fermentables-other-grain">Other Grain</a></li>
            <li class="nav-item"><a class="nav-link px-2 py-1" data-toggle="tab" role="tab" data-filter="sugar" href="#chart-fermentables-sugar">Sugar</a></li>
            <li class="nav-item"><a class="nav-link px-2 py-1" data-toggle="tab" role="tab" data-filter="fruit" href="#chart-fermentables-fruit">Fruit</a></li>
        </ul>
    </nav>
    <div id="chart-fermentables" class="chart-l">
        <noscript>
            {{ style|chart_image:"popular-fermentables"|safe }}
        </noscript>
    </div>

    <h2>Most Used Hops</h2>
    <nav id="chart-hops-tabs">
        <label for="chart-hops-tabs" class="float-left py-1 pr-2">Used for:</label>
        <ul class="nav nav-pills" role="tablist">
            <li class="nav-item"><a class="nav-link px-2 py-1 active" aria-current="page" data-toggle="tab" role="tab" data-filter="" href="#chart-hops">Any</a></li>
            <li class="nav-item"><a class="nav-link px-2 py-1" data-toggle="tab" role="tab" data-filter="bittering" href="#chart-hops-bittering">Bittering</a></li>
            <li class="nav-item"><a class="nav-link px-2 py-1" data-toggle="tab" role="tab" data-filter="aroma" href="#chart-hops-aroma">Aroma</a></li>
            <li class="nav-item"><a class="nav-link px-2 py-1" data-toggle="tab" role="tab" data-filter="dry-hop" href="#chart-hops-dry-hop">Dry-Hop</a></li>
        </ul>
    </nav>
    <div id="chart-hops" class="chart-l">
        <noscript>
            {{ style|chart_image:"popular-hops"|safe }}
        </noscript>
    </div>

    <h2>Common Hop Pairings</h2>
    <div id="chart-hop-pairings" class="chart-l">
        <noscript>
            {{ style|chart_image:"hop-pairings"|safe }}
        </noscript>
    </div>
{% endblock %}

{% block script %}
<script>
window.addEventListener('load', function ()
{
    // Metrics
    display_graph('chart-spec-abv', '{{ style|chart_js:"abv-histogram" }}', {displayModeBar: false});
    display_graph('chart-spec-ibu', '{{ style|chart_js:"ibu-histogram" }}', {displayModeBar: false});
    display_graph('chart-spec-color', '{{ style|chart_js:"color-srm-histogram" }}', {displayModeBar: false});
    display_graph('chart-spec-og', '{{ style|chart_js:"original-gravity-histogram" }}', {displayModeBar: false});
    display_graph('chart-spec-fg', '{{ style|chart_js:"final-gravity_histogram" }}', {displayModeBar: false});

    // Charts
    display_graph('chart-popularity', '{{ style|chart_js:"popularity" }}');
    display_graph_with_navigation('chart-fermentables', 'chart-fermentables-tabs', '{{ style|chart_js:"popular-fermentables" }}');
    display_graph_with_navigation('chart-hops', 'chart-hops-tabs', '{{ style|chart_js:"popular-hops" }}');
    display_graph('chart-hop-pairings', '{{ style|chart_js:"hop-pairings" }}');
});
</script>
{% endblock %}

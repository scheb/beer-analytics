{% extends 'base.html' %}
{% load web_app %}

{% block title %}{{ fermentable.name }} â€¹ Fermentables{% endblock %}

{% block content %}
    <nav aria-label="breadcrumb" class="mt-3">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url "fermentable_overview" %}">Fermentables</a></li>
            <li class="breadcrumb-item"><a href="{% url "fermentable_category" fermentable.category %}">{{ fermentable.category_name }} Fermentables</a></li>
            <li class="breadcrumb-item active">{{ fermentable.name }}</li>
        </ol>
    </nav>

    <h1>{{ fermentable.name }}</h1>

    {% if fermentable.alt_names %}
        <p>Includes: <span class="badge bg-secondary">{{ fermentable.alt_names_list|join:'</span><span class="invisible">, </span><span class="badge bg-secondary">' }}</span></p>
    {% endif %}

    <p>Type: <strong>{{ fermentable.type_name }}</strong></p>
    <p>Number of recipes: <strong>{{ fermentable.recipes_count }}</strong></p>

    {% include './metrics.html' %}

    <h2>Popularity Over Time</h2>
    <div id="chart-popularity" class="chart-m">
        <noscript>
            {{ fermentable|chart_image:"popularity"|safe }}
        </noscript>
    </div>

    <h2>Typical Styles</h2>
    <h3>Absolute Number of Recipes</h3>
    <div id="chart-styles-abs" class="chart-l">
        <noscript>
            {{ fermentable|chart_image:"typical-styles-absolute"|safe }}
        </noscript>
    </div>
    <h3>Relative Percent of Recipes</h3>
    <div id="chart-styles-rel" class="chart-l">
        <noscript>
            {{ fermentable|chart_image:"typical-styles-relative"|safe }}
        </noscript>
    </div>

    <h2>Amount per Style</h2>
    <div id="chart-style-amount" class="chart-l">
        <noscript>
            {{ fermentable|chart_image:"amount-used-per-style"|safe }}
        </noscript>
    </div>

    <h2>Common Pairings</h2>
    <div id="chart-pairings" class="chart-l">
        <noscript>
            {{ fermentable|chart_image:"fermentable-pairings"|safe }}
        </noscript>
    </div>
{% endblock %}

{% block script %}
<script>
window.addEventListener('load', function ()
{
    // Metrics
    display_graph('chart-metric-color', '{{ fermentable|chart_js:"color-histogram" }}', {displayModeBar: false});
    display_graph('chart-metric-amount-percent', '{{ fermentable|chart_js:"amount-percent-range" }}', {displayModeBar: false});

    // Charts
    display_graph('chart-popularity', '{{ fermentable|chart_js:"popularity" }}');
    display_graph('chart-styles-abs', '{{ fermentable|chart_js:"typical-styles-absolute" }}');
    display_graph('chart-styles-rel', '{{ fermentable|chart_js:"typical-styles-relative" }}');
    display_graph('chart-style-amount', '{{ fermentable|chart_js:"amount-used-per-style" }}');
    display_graph('chart-pairings', '{{ fermentable|chart_js:"fermentable_pairings" }}');
});
</script>
{% endblock %}
